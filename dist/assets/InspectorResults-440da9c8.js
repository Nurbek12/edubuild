import{a as p}from"./index-7376b9a9.js";import{u as G,r as u,m as I,a as l,o as L,c as K,w as e,b as t,f,d as s,t as m,n as O}from"./index-1590be2c.js";const P=s("span",{class:"text-h5"},"Natijalar",-1),Y={class:"responsive-datatable"},A={"data-label":"T/r"},D={"data-label":"Test nomi"},E={"data-label":"Talaba"},H={"data-label":"Guruhi"},M={"data-label":"Bahosi"},J={"data-label":"Foizi"},Q={"data-label":"Ko'rish"},W={"data-label":"Boshqarish"},X={class:"d-flex justify-end"},Z=s("div",null,"Hech narsa topilmadi",-1),oe={__name:"InspectorResults",setup(ee){G();const V=[{key:"student.group",order:"asc"}],T=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Test Nomi",key:"test.name"},{title:"Talaba",key:"student.name"},{title:"Guruhi",key:"student.group"},{title:"Bahosi",key:"rate"},{title:"Foizi",key:"percent"},{title:"Ko'rish",key:"view"}],C=u(""),_=u(!1),h=u([]),b=u([]),w=u([]),n=u({group:"",test:"",student:""}),y=u(!1),B=async()=>{const[r,o]=await Promise.all([p.get("/test/result/"),p.get("/all/names")]);b.value=o.data.tests,w.value=o.data.groups,h.value=r.data};async function U(){for(const o in n.value)(n.value[o]===null||n.value[o]==="")&&delete n.value[o];const r=new URLSearchParams(n.value).toString();y.value=!0,await p({method:"get",url:"/test/download?"+r,responseType:"blob",headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}}).then(o=>{const d=window.URL.createObjectURL(new Blob([o.data])),i=document.createElement("a");i.href=d,i.setAttribute("download","result.xlsx"),document.body.appendChild(i),i.click()}),y.value=!1}const j=()=>{_.value=!1,O(()=>{Object.assign(n.value,{group:"",test:"",student:""})})};return I(_,r=>r||j()),B(),(r,o)=>{const d=l("v-col"),i=l("v-btn"),v=l("v-row"),g=l("v-sheet"),z=l("v-spacer"),N=l("v-data-table"),q=l("v-card-title"),k=l("v-select"),F=l("v-form"),x=l("v-container"),R=l("v-card-text"),S=l("v-card"),$=l("v-dialog");return L(),K(x,{fluid:""},{default:e(()=>[t(v,null,{default:e(()=>[t(d,{cols:"12"},{default:e(()=>[t(g,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[t(v,{justify:"space-between",align:"center"},{default:e(()=>[t(d,{cols:"12",sm:"4"},{default:e(()=>[P]),_:1}),t(d,{cols:"12",sm:"4",md:"3"},{default:e(()=>[t(i,{block:"",color:"green",onClick:o[0]||(o[0]=a=>_.value=!0),variant:"tonal"},{default:e(()=>[f("Yuklab olish")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(g,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:e(()=>[s("div",Y,[t(N,{headers:T,search:C.value,items:h.value,"group-by":V},{"item.no":e(({index:a})=>[s("td",A,m(a)+".",1)]),"item.test.name":e(({item:a})=>[s("td",D,m(a.raw.test.name),1)]),"item.student.name":e(({item:a})=>{var c;return[s("td",E,m((c=a.raw.student)==null?void 0:c.name),1)]}),"item.student.group":e(({item:a})=>{var c;return[s("td",H,m((c=a.raw.student)==null?void 0:c.group),1)]}),"item.rate":e(({item:a})=>[s("td",M,m(a.raw.rate),1)]),"item.percent":e(({item:a})=>[s("td",J,m(parseFloat(a.raw.rate*100/a.raw.questions).toFixed(1))+" % ",1)]),"item.view":e(({item:a})=>[s("td",Q,[t(i,{color:"primary",icon:"mdi-eye-arrow-right",variant:"text",to:`/test/${a.raw._id}`},null,8,["to"])])]),"item.actions":e(({item:a})=>[s("td",W,[t(z),s("div",X,[t(i,{icon:"mdi-pencil",variant:"text",size:"40",color:"primary",onClick:c=>r.editItem(a.raw)},null,8,["onClick"]),t(i,{icon:"mdi-delete",variant:"text",size:"40",color:"primary",onClick:c=>r.deleteItem(a.raw)},null,8,["onClick"])])])]),"no-data":e(()=>[Z]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),t($,{modelValue:_.value,"onUpdate:modelValue":o[3]||(o[3]=a=>_.value=a),"max-width":"550px"},{default:e(()=>[t(S,null,{default:e(()=>[t(R,{class:"px-2 pt-0"},{default:e(()=>[t(x,null,{default:e(()=>[t(F,{ref:"form"},{default:e(()=>[t(v,null,{default:e(()=>[t(q,null,{default:e(()=>[f("Ma'lumotlarni yuklab olish")]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(k,{modelValue:n.value.test,"onUpdate:modelValue":o[1]||(o[1]=a=>n.value.test=a),items:b.value,label:"Test bo'yicha",clearable:"","clear-icon":"mdi-close","hide-details":"","item-title":"name",color:"primary","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(k,{modelValue:n.value.group,"onUpdate:modelValue":o[2]||(o[2]=a=>n.value.group=a),clearable:"","clear-icon":"mdi-close",label:"Guruh bo'yicha",items:w.value,"hide-details":"","item-title":"name",color:"primary","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),t(d,{cols:"12"},{default:e(()=>[t(i,{variant:"tonal",color:"primary",block:"",onClick:U,height:"45"},{default:e(()=>[f(" Yuklab olish ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{oe as default};
