import{a as b}from"./index-7376b9a9.js";import{r as u,l as W,m as P,a as s,o as X,c as Z,w as a,b as e,f as y,d as i,t as m,e as ee,n as D}from"./index-1590be2c.js";const ae={class:"responsive-datatable"},le={"data-label":"T/r"},te={"data-label":"Boshqarish"},oe={class:"d-flex justify-end"},ne={"data-label":"Ism familiyasi"},se={"data-label":"Guruhi"},ie={"data-label":"Login"},de={"data-label":"Paroli"},ue={"data-label":"Telefoni"},re={"data-label":"Tugilgan sanasi"},ce=i("div",null,"Hech narsa topilmadi",-1),me={class:"text-h5"},fe={__name:"Students",setup(ve){const v=[t=>!!t||"Required"],G=[{title:"T/r",align:"start",key:"no",sortable:!1},{title:"Ism familiyasi",key:"name"},{title:"Guruhi",key:"group"},{title:"Login",key:"login"},{title:"Paroli",key:"password"},{title:"Telefoni",key:"phone"},{title:"Tugilgan sanasi",key:"birthdate"},{title:"Boshqarish",align:"end",key:"actions",sortable:!1}],w=u(""),c=u([]),_=u(!1),V=u(null),g=u(!1),r=u(-1),p=u(-1),k=u([]),n=u({name:"",birthdate:"",phone:"",login:"",password:"",group:"",role:"student"}),I={name:"",birthdate:"",phone:"",login:"",password:"",group:"",role:"student"},L=W(()=>r.value===-1?"Talaba yaratish":"Talabani o'zgartirish");P(_,t=>t||x()),P(g,t=>t||T());const N=async()=>{const[t,o]=await Promise.all([b.get("/user/student"),b.get("/group")]);c.value=t.data,k.value=o.data},S=async()=>{const{valid:t}=await V.value.validate();t&&R()},H=t=>{r.value=c.value.indexOf(t),p.value=t._id,n.value=Object.assign({},t),_.value=!0},Y=t=>{r.value=c.value.indexOf(t),n.value=Object.assign({},t),p.value=t._id,g.value=!0},Q=async()=>{const{data:t}=await b.delete(`/user/${p.value}`);t&&(c.value.splice(r.value,1),T())},x=()=>{_.value=!1,D(()=>{var t;n.value=Object.assign({},I),p.value=-1,r.value=-1,(t=V.value)==null||t.reset()})},T=()=>{g.value=!1,D(()=>{var t;n.value=Object.assign({},I),p.value=-1,r.value=-1,(t=V.value)==null||t.reset()})},R=async()=>{if(r.value>-1){const{data:t}=await b.put(`/user/${p.value}`,n.value);t?(Object.assign(c.value[r.value],t),x()):n.value.login=""}else{const{data:t}=await b.post("/user",n.value);t?(c.value.push(t),x()):n.value.login=""}};return N(),(t,o)=>{const f=s("v-text-field"),d=s("v-col"),h=s("v-btn"),U=s("v-row"),j=s("v-sheet"),A=s("v-select"),E=s("v-data-table"),q=s("v-card-title"),F=s("v-autocomplete"),J=s("v-form"),O=s("v-container"),K=s("v-card-text"),z=s("v-card"),B=s("v-dialog"),$=s("v-spacer"),M=s("v-card-actions");return X(),Z(O,{fluid:""},{default:a(()=>[e(U,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(j,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[e(U,{justify:"space-between"},{default:a(()=>[e(d,{cols:"12",sm:"4"},{default:a(()=>[e(f,{label:"Qidirish",modelValue:w.value,"onUpdate:modelValue":o[0]||(o[0]=l=>w.value=l),variant:"outlined",color:"primary",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"4",md:"3"},{default:a(()=>[e(h,{block:"",color:"primary",onClick:o[1]||(o[1]=l=>_.value=!0),variant:"tonal"},{default:a(()=>[y("Yangi Talaba")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(j,{elevation:"1",color:"surface",width:"100%",class:"pa-2",rounded:""},{default:a(()=>[i("div",ae,[e(E,{headers:G,search:w.value,items:c.value},{"item.no":a(({index:l})=>[i("td",le,m(l+1)+".",1)]),"item.actions":a(({item:l})=>[i("td",te,[i("div",oe,[e(h,{icon:"mdi-pencil",variant:"text",size:"40",color:"primary",onClick:C=>H(l.raw)},null,8,["onClick"]),e(h,{icon:"mdi-delete",variant:"text",size:"40",color:"primary",onClick:C=>Y(l.raw)},null,8,["onClick"])])])]),"item.name":a(({item:l})=>[i("td",ne,m(l.raw.name),1)]),"item.group":a(({item:l})=>[i("td",se,[e(A,{items:k.value,readonly:"",chips:"","item-value":"_id","item-title":"name",variant:"solo","hide-details":"",flat:"",modelValue:l.raw.group,"onUpdate:modelValue":C=>l.raw.group=C},null,8,["items","modelValue","onUpdate:modelValue"])])]),"item.login":a(({item:l})=>[i("td",ie,m(l.raw.login),1)]),"item.password":a(({item:l})=>[i("td",de,m(l.raw.password),1)]),"item.phone":a(({item:l})=>[i("td",ue,m(l.raw.phone),1)]),"item.birthdate":a(({item:l})=>[i("td",re,m(l.raw.birthdate),1)]),"no-data":a(()=>[ce]),_:1},8,["search","items"])])]),_:1})]),_:1})]),_:1}),e(B,{modelValue:_.value,"onUpdate:modelValue":o[8]||(o[8]=l=>_.value=l),"max-width":"550px"},{default:a(()=>[e(z,null,{default:a(()=>[e(q,{class:"mt-2 ml-2 mb-0"},{default:a(()=>[i("span",me,m(ee(L)),1)]),_:1}),e(K,{class:"px-2 pt-0"},{default:a(()=>[e(O,null,{default:a(()=>[e(J,{ref_key:"form",ref:V},{default:a(()=>[e(U,null,{default:a(()=>[e(d,{cols:"12"},{default:a(()=>[e(f,{modelValue:n.value.name,"onUpdate:modelValue":o[2]||(o[2]=l=>n.value.name=l),label:"Ism familiya","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(F,{modelValue:n.value.group,"onUpdate:modelValue":o[3]||(o[3]=l=>n.value.group=l),label:"Guruhi",rules:v,"hide-details":"",items:k.value,color:"primary","item-title":"name","item-value":"_id",variant:"outlined"},null,8,["modelValue","items"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:n.value.phone,"onUpdate:modelValue":o[4]||(o[4]=l=>n.value.phone=l),label:"Telefon raqami","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:n.value.birthdate,"onUpdate:modelValue":o[5]||(o[5]=l=>n.value.birthdate=l),label:"Tug'ilgan sanasi","hide-details":"",type:"date",color:"primary",rules:v,variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:n.value.login,"onUpdate:modelValue":o[6]||(o[6]=l=>n.value.login=l),label:"Login","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12",sm:"6"},{default:a(()=>[e(f,{modelValue:n.value.password,"onUpdate:modelValue":o[7]||(o[7]=l=>n.value.password=l),label:"Parol","hide-details":"",rules:v,color:"primary",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(d,{cols:"12"},{default:a(()=>[e(h,{variant:"tonal",color:"primary",block:"",onClick:S,height:"45"},{default:a(()=>[y(" Saqlash ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(B,{modelValue:g.value,"onUpdate:modelValue":o[9]||(o[9]=l=>g.value=l),"max-width":"500px"},{default:a(()=>[e(z,null,{default:a(()=>[e(q,{class:"text-h6"},{default:a(()=>[y(" Ushbu ma'lumotni ochirmoqchimisiz ")]),_:1}),e(M,null,{default:a(()=>[e($),e(h,{color:"blue-darken-1",variant:"text",onClick:T},{default:a(()=>[y(" Yo'q ")]),_:1}),e(h,{color:"blue-darken-1",variant:"text",onClick:Q},{default:a(()=>[y(" Ha ")]),_:1}),e($)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};export{fe as default};
